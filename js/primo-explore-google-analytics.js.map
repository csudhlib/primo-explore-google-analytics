{"version":3,"sources":["primo-explore-google-analytics.js"],"names":["angular","module","run","$rootScope","$interval","analyticsOptions","hasOwnProperty","enabled","siteId","ga","i","s","o","g","r","a","m","q","push","arguments","l","Date","createElement","getElementsByTagName","async","src","parentNode","insertBefore","window","document","$on","event","toState","fromState","documentTitle","defaultTitle","interval","title","location","pathname","indexOf","element","querySelector","length","text","cancel","value"],"mappings":"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","file":"primo-explore-google-analytics.js","sourcesContent":["angular.module('primo-explore-google-analytics', []);\r\nangular.module('primo-explore-google-analytics').run(function ($rootScope, $interval, analyticsOptions) {\r\n\tif(analyticsOptions.hasOwnProperty(\"enabled\") && analyticsOptions.enabled) {\r\n\t\tif(analyticsOptions.hasOwnProperty(\"siteId\") && analyticsOptions.siteId != '') {\r\n\t\t\tif(typeof ga === 'undefined') {\r\n\t\t\t\t(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\r\n\t\t\t\t(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\r\n\t\t\t\tm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\r\n\t\t\t\t})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\r\n\r\n\t\t\t\tga('create', analyticsOptions.siteId, {'alwaysSendReferrer': true});\r\n\t\t\t\tga('set', 'anonymizeIp', true);\r\n\t\t\t}\r\n\t\t}\r\n\t\t$rootScope.$on('$locationChangeSuccess', function (event, toState, fromState) {\r\n\t\t\tif(analyticsOptions.hasOwnProperty(\"defaultTitle\")) {\r\n\t\t\t\tvar documentTitle = analyticsOptions.defaultTitle;\r\n\t\t\t\tvar interval = $interval(function () {\r\n\t\t\t\t\tif(document.title !== '') documentTitle = document.title;\r\n\t\t\t\t\tif (window.location.pathname.indexOf('openurl') !== -1 || window.location.pathname.indexOf('fulldisplay') !== -1)\r\n\t\t\t\t\t\tif (angular.element(document.querySelector('prm-full-view-service-container .item-title>a')).length === 0) return;\r\n\t\t\t\t\t\telse documentTitle = angular.element(document.querySelector('prm-full-view-service-container .item-title>a')).text();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(typeof ga !== 'undefined') {\r\n\t\t\t\t\t\tif(fromState != toState) ga('set', 'referrer', fromState);\r\n\t\t\t\t\t\tga('set', 'location', toState);\r\n\t\t\t\t\t\tga('set', 'title', documentTitle);\r\n\t\t\t\t\t\tga('send', 'pageview');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$interval.cancel(interval);\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});\r\nangular.module('primo-explore-google-analytics').value('analyticsOptions', {\r\n\tenabled: true,\r\n\tsiteId: '',\r\n\tdefaultTitle: ''\r\n});"]}